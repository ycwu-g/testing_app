name: Loki

env:
  TIME_OUT: 10

on:
  push:
    branches:
    - master
  pull_request:
    branches:
    - master

jobs:
  android-build:
    name: Android Build
    runs-on: ubuntu-latest
    timeout-minutes: ${{ TIME_OUT }}
    steps:
      - name: Dumping Repo Info
        env: 
          GITHUB_CONTEXT: ${{ toJSON(github) }}
        run: echo "$GITHUB_CONTEXT"
      
      - name: Check out
        uses: actions/checkout@v2
      
      - name: Setup Java
        uses: actions/setup-java@v1
        with:
          java-version: '12.x'
      
      # Setup the flutter environment.
      - name: Calling subosito/flutter action
        uses: subosito/flutter-action@v1
        with:
          channel: 'stable' # 'dev', 'alpha', default to: 'stable'
          # flutter-version: '1.12.x' # you can also specify exact version of flutter
      
      # Get flutter dependencies and build apk
      - name: Pub get and build apk
        run: |
          flutter pub get
          flutter build apk

      # Upload generated apk to the artifacts.
      - name: Save artifact
        uses: actions/upload-artifact@v1
        with:
          name: release-apk
          path: build/app/outputs/apk/release/app-release.apk
